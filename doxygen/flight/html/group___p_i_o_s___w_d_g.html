<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>TauLabs: Watchdog Functions</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="icon_128x128.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TauLabs
   
   </div>
   <div id="projectbrief">TauLabsfirmware</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group___p_i_o_s___w_d_g.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Watchdog Functions</div>  </div>
<div class="ingroups"><a class="el" href="group___p_i_o_s.html">PIOS Core hardware abstraction layer</a></div></div><!--header-->
<div class="contents">

<p>PIOS Comamnds to initialize and clear watchdog timer.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>wdg_configuration</b></td></tr>
<tr><td colspan="2"><h2><a name="files"></a>
Files</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pios__wdg_8h.html">pios_wdg.h</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>SPI functions header. </p>
<br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga1ffcba6811cce798c0a6bc014a691dc7">PIOS_WDG_Init</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the watchdog timer for a specified timeout.  <a href="#ga1ffcba6811cce798c0a6bc014a691dc7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga181128f13ffdec27ea07e13fc4a4e1ab">PIOS_WDG_RegisterFlag</a> (uint16_t flag_requested)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a module against the watchdog.  <a href="#ga181128f13ffdec27ea07e13fc4a4e1ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga4698d93015624e320b5c7c980c4edecd">PIOS_WDG_UpdateFlag</a> (uint16_t flag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Function called by modules to indicate they are still running.  <a href="#ga4698d93015624e320b5c7c980c4edecd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga0cb157cf1f3763126ab097d9bf67658b">PIOS_WDG_GetBootupFlags</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the flags that were set at bootup.  <a href="#ga0cb157cf1f3763126ab097d9bf67658b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga725a2e6282c5cb3c63d5c022204aec22">PIOS_WDG_GetActiveFlags</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the currently active flags.  <a href="#ga725a2e6282c5cb3c63d5c022204aec22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga49f0e0259a9db3551d437e5d74fd48a1">PIOS_WDG_Clear</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear the watchdog timer.  <a href="#ga49f0e0259a9db3551d437e5d74fd48a1"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga5256cc27a9d0a00ca6392a56ff3426e0">wdg_configuration::used_flags</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_i_o_s___w_d_g.html#ga52dc5a350735444a607b0dfd24d49371">wdg_configuration::bootup_flags</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>PIOS Comamnds to initialize and clear watchdog timer. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga49f0e0259a9db3551d437e5d74fd48a1"></a><!-- doxytag: member="pios_wdg.h::PIOS_WDG_Clear" ref="ga49f0e0259a9db3551d437e5d74fd48a1" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group___p_i_o_s___w_d_g.html#ga49f0e0259a9db3551d437e5d74fd48a1">PIOS_WDG_Clear</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clear the watchdog timer. </p>
<p>This function must be called at the appropriate delay to prevent a reset event occuring </p>

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00167">167</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga725a2e6282c5cb3c63d5c022204aec22"></a><!-- doxytag: member="pios_wdg.h::PIOS_WDG_GetActiveFlags" ref="ga725a2e6282c5cb3c63d5c022204aec22" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="group___p_i_o_s___w_d_g.html#ga725a2e6282c5cb3c63d5c022204aec22">PIOS_WDG_GetActiveFlags</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the currently active flags. </p>
<p>For external monitoring</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The active flags register </dd></dl>

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00157">157</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga0cb157cf1f3763126ab097d9bf67658b"></a><!-- doxytag: member="pios_wdg.h::PIOS_WDG_GetBootupFlags" ref="ga0cb157cf1f3763126ab097d9bf67658b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="group___p_i_o_s___w_d_g.html#ga0cb157cf1f3763126ab097d9bf67658b">PIOS_WDG_GetBootupFlags</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the flags that were set at bootup. </p>
<p>This is used for diagnostics, if only one flag not set this was likely the module that wasn't running before reset</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The active flags register from bootup </dd></dl>

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00145">145</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga1ffcba6811cce798c0a6bc014a691dc7"></a><!-- doxytag: member="pios_wdg.h::PIOS_WDG_Init" ref="ga1ffcba6811cce798c0a6bc014a691dc7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="group___p_i_o_s___w_d_g.html#ga1ffcba6811cce798c0a6bc014a691dc7">PIOS_WDG_Init</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the watchdog timer for a specified timeout. </p>
<p>It is important to note that this function returns the achieved timeout for this hardware. For hardware independence this should be checked when scheduling updates. Other hardware dependent details may need to be considered such as a window time which sets a minimum update time, and this function should return a recommended delay for clearing.</p>
<p>For the STM32 nominal clock rate is 32 khz, but for the maximum clock rate of 60 khz and a prescaler of 4 yields a clock rate of 15 khz. The delay that is set in the watchdog assumes the nominal clock rate, but the delay for FreeRTOS to use is 75% of the minimal delay.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Maximum recommended delay between updates based on PIOS_WATCHDOG_TIMEOUT constant </dd></dl>

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00060">60</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga181128f13ffdec27ea07e13fc4a4e1ab"></a><!-- doxytag: member="pios_wdg.h::PIOS_WDG_RegisterFlag" ref="ga181128f13ffdec27ea07e13fc4a4e1ab" args="(uint16_t flag_requested)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="group___p_i_o_s___w_d_g.html#ga181128f13ffdec27ea07e13fc4a4e1ab">PIOS_WDG_RegisterFlag</a> </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>flag_requested</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register a module against the watchdog. </p>
<p>There are two ways to use PIOS WDG: this is for when multiple modules must be monitored. In this case they must first register against the watchdog system and only when all of the modules have been updated with the watchdog be cleared. Each module must have its own bit in the 16 bit</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flag</td><td>the bit this module wants to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>True if that bit is unregistered </dd></dl>

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00095">95</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga4698d93015624e320b5c7c980c4edecd"></a><!-- doxytag: member="pios_wdg.h::PIOS_WDG_UpdateFlag" ref="ga4698d93015624e320b5c7c980c4edecd" args="(uint16_t flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="group___p_i_o_s___w_d_g.html#ga4698d93015624e320b5c7c980c4edecd">PIOS_WDG_UpdateFlag</a> </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Function called by modules to indicate they are still running. </p>
<p>This function will set this flag in the active flags register (which is a backup regsiter) and if all the registered flags are set will clear the watchdog and set only this flag in the backup register</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flag</td><td>the flag to set </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if the watchdog cleared, false if flags are pending </dd></dl>

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00118">118</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ga52dc5a350735444a607b0dfd24d49371"></a><!-- doxytag: member="wdg_configuration::bootup_flags" ref="ga52dc5a350735444a607b0dfd24d49371" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t wdg_configuration::bootup_flags</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00041">41</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga5256cc27a9d0a00ca6392a56ff3426e0"></a><!-- doxytag: member="wdg_configuration::used_flags" ref="ga5256cc27a9d0a00ca6392a56ff3426e0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t wdg_configuration::used_flags</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html#l00040">40</a> of file <a class="el" href="_s_t_m32_f10x_2pios__wdg_8c_source.html">pios_wdg.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
