<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>TauLabs: /home/jb/code/TauLabs/ground/gcs/src/plugins/uavobjects/OPPlots.m Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="icon_128x128.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TauLabs
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_o_p_plots_8m.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">/home/jb/code/TauLabs/ground/gcs/src/plugins/uavobjects/OPPlots.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_o_p_plots_8m.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="keyword">function</span> <a class="code" href="_o_p_plots_8m.html#a3efffb7acbd6d5c2b21b21ced1cf33d6">OPPlots</a>()
<a name="l00002"></a><a class="code" href="_o_p_plots_8m.html#a33c6b187b4cb2d60ccdb31260e72b8e7">00002</a>     [FileName,PathName,FilterIndex] = uigetfile(<span class="stringliteral">&#39;*.mat&#39;</span>);
<a name="l00003"></a><a class="code" href="_o_p_plots_8m.html#aba69459d5095ae56cf63e6a66b89648b">00003</a>     <a class="code" href="_o_p_plots_8m.html#aba69459d5095ae56cf63e6a66b89648b">matfile</a> = strcat(<a class="code" href="_o_p_plots_8m.html#a33c6b187b4cb2d60ccdb31260e72b8e7">PathName</a>,FileName);
<a name="l00004"></a>00004     <a class="code" href="_o_p_plots_8m.html#aea8163c028990a164233458eddb56b9a">load</a>(<a class="code" href="_o_p_plots_8m.html#aba69459d5095ae56cf63e6a66b89648b">matfile</a>);
<a name="l00005"></a>00005          
<a name="l00006"></a>00006     %<a class="code" href="_o_p_plots_8m.html#aea8163c028990a164233458eddb56b9a">load</a>(<span class="stringliteral">&#39;specificfilename&#39;</span>)
<a name="l00007"></a>00007 
<a name="l00008"></a>00008     TimeVA = [VelocityActual.timestamp]/1000;
<a name="l00009"></a><a class="code" href="_o_p_plots_8m.html#adbc0f501352771d9673ef29ca61494c8">00009</a>     <a class="code" href="_o_p_plots_8m.html#adbc0f501352771d9673ef29ca61494c8">VA</a> = [[VelocityActual.North]
<a name="l00010"></a>00010           [VelocityActual.East]
<a name="l00011"></a>00011           [VelocityActual.Down]]/100;
<a name="l00012"></a>00012 
<a name="l00013"></a><a class="code" href="_o_p_plots_8m.html#ac835a48a2b20ca286d21d5530bc2269c">00013</a>     <a class="code" href="_o_p_plots_8m.html#ac835a48a2b20ca286d21d5530bc2269c">TimeGPSPos</a> = [GPSPosition.timestamp]/1000;
<a name="l00014"></a><a class="code" href="_o_p_plots_8m.html#ab441b3f8e4278847ca7f9bfdd0e42cd2">00014</a>     <a class="code" href="_o_p_plots_8m.html#ab441b3f8e4278847ca7f9bfdd0e42cd2">Vgps</a>=[[GPSPosition.Groundspeed].*cos([GPSPosition.Heading]*pi/180)
<a name="l00015"></a>00015           [GPSPosition.Groundspeed].*sin([GPSPosition.Heading]*pi/180)];
<a name="l00016"></a>00016 
<a name="l00017"></a>00017     <a class="code" href="_o_p_plots_8m.html#a39cc4eae8cc13eaea23364936540819f">figure</a>(1);
<a name="l00018"></a>00018     <a class="code" href="_o_p_plots_8m.html#a4fbe616a6cbdd6d58fdf12c2d18a0846">plot</a>(TimeVA,<a class="code" href="_o_p_plots_8m.html#adbc0f501352771d9673ef29ca61494c8">VA</a>(1,:),TimeVA,VA(2,:),<a class="code" href="_o_p_plots_8m.html#ac835a48a2b20ca286d21d5530bc2269c">TimeGPSPos</a>,<a class="code" href="_o_p_plots_8m.html#ab441b3f8e4278847ca7f9bfdd0e42cd2">Vgps</a>(1,:),TimeGPSPos,Vgps(2,:));
<a name="l00019"></a><a class="code" href="_o_p_plots_8m.html#a2f07e0f444810cc4e54ee2be2ce0ac65">00019</a>     <a class="code" href="_o_p_plots_8m.html#a2f07e0f444810cc4e54ee2be2ce0ac65">s1</a>=&#39;Velocity Actual North&#39;;
<a name="l00020"></a><a class="code" href="_o_p_plots_8m.html#a2e63e71737e8b6802b81f6a7c5ca6a0a">00020</a>     <a class="code" href="_o_p_plots_8m.html#a2e63e71737e8b6802b81f6a7c5ca6a0a">s2</a>=&#39;Velocity Actual East&#39;;
<a name="l00021"></a><a class="code" href="_o_p_plots_8m.html#a62909dec3830967c3ffff61bd5d4d3fa">00021</a>     <a class="code" href="_o_p_plots_8m.html#a62909dec3830967c3ffff61bd5d4d3fa">s3</a>=&#39;GPS Velocity North&#39;;
<a name="l00022"></a><a class="code" href="_o_p_plots_8m.html#a2b19ae910d39ba13899d0aff1c910363">00022</a>     <a class="code" href="_o_p_plots_8m.html#a2b19ae910d39ba13899d0aff1c910363">s4</a>=&#39;GPS Velocity East&#39;;
<a name="l00023"></a>00023     <a class="code" href="_o_p_plots_8m.html#acc66d65ee6dadbb2f185aed799ac4ff9">legend</a>(<a class="code" href="_o_p_plots_8m.html#a2f07e0f444810cc4e54ee2be2ce0ac65">s1</a>,<a class="code" href="_o_p_plots_8m.html#a2e63e71737e8b6802b81f6a7c5ca6a0a">s2</a>,<a class="code" href="_o_p_plots_8m.html#a62909dec3830967c3ffff61bd5d4d3fa">s3</a>,<a class="code" href="_o_p_plots_8m.html#a2b19ae910d39ba13899d0aff1c910363">s4</a>);
<a name="l00024"></a>00024     <a class="code" href="_o_p_plots_8m.html#a2f72e827cc4394f62071090c2785a845">xlabel</a>(&#39;Time (sec)&#39;);
<a name="l00025"></a>00025     <a class="code" href="_o_p_plots_8m.html#acd883c737a299f2b0119aefb3cc90fc7">ylabel</a>(&#39;Velocity (<a class="code" href="uavobjecttemplate_8m.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>/<a class="code" href="uavobjecttemplate_8m.html#a3691308f2a4c2f6983f2880d32e29c84">s</a>)&#39;);
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="_o_p_plots_8m.html#a354816d1f6a938030581fd6d1ccfebed">00028</a>     <a class="code" href="_o_p_plots_8m.html#a354816d1f6a938030581fd6d1ccfebed">TimePA</a> = [PositionActual.timestamp]/1000;
<a name="l00029"></a><a class="code" href="_o_p_plots_8m.html#a1eee7e566c5e608fa3a769ba1cdacfa6">00029</a>     <a class="code" href="_o_p_plots_8m.html#a1eee7e566c5e608fa3a769ba1cdacfa6">PA</a> = [[PositionActual.North]
<a name="l00030"></a>00030           [PositionActual.East]
<a name="l00031"></a>00031           [PositionActual.Down]]/100;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033     TimeGPSPos = [GPSPosition.timestamp]/1000;
<a name="l00034"></a><a class="code" href="_o_p_plots_8m.html#a011779f2c5f2a3505308bb1369101a54">00034</a>     <a class="code" href="_o_p_plots_8m.html#a011779f2c5f2a3505308bb1369101a54">LLA</a>=[[GPSPosition.Latitude]*1<a class="code" href="_o_p_plots_8m.html#a9425be9aab51621e317ba7ade564b570">e</a>-7;
<a name="l00035"></a>00035          [GPSPosition.Longitude]*1e-7;
<a name="l00036"></a>00036          [GPSPosition.Altitude]+[GPSPosition.GeoidSeparation]];
<a name="l00037"></a><a class="code" href="_o_p_plots_8m.html#ac1ec51a7dd6d455e7752b2436fd61a0c">00037</a>     <a class="code" href="_o_p_plots_8m.html#ac1ec51a7dd6d455e7752b2436fd61a0c">BaseECEF</a> = LLA2ECEF([HomeLocation.Latitude*1e-7, HomeLocation.Longitude*1e-7, HomeLocation.Altitude]&#39;);
<a name="l00038"></a><a class="code" href="_o_p_plots_8m.html#a29600f30d6d5478f57eb98ded59e49f4">00038</a>     <a class="code" href="_o_p_plots_8m.html#a29600f30d6d5478f57eb98ded59e49f4">Rne</a> = RneFromLLA([HomeLocation.Latitude*1e-7, HomeLocation.Longitude*1e-7, HomeLocation.Altitude]&#39;);
<a name="l00039"></a><a class="code" href="_o_p_plots_8m.html#ab94cab93b013b179c5a536b9c11a579d">00039</a>     <a class="code" href="_o_p_plots_8m.html#ab94cab93b013b179c5a536b9c11a579d">GPSPos</a>=LLA2Base(<a class="code" href="_o_p_plots_8m.html#a011779f2c5f2a3505308bb1369101a54">LLA</a>,<a class="code" href="_o_p_plots_8m.html#ac1ec51a7dd6d455e7752b2436fd61a0c">BaseECEF</a>,<a class="code" href="_o_p_plots_8m.html#a29600f30d6d5478f57eb98ded59e49f4">Rne</a>); 
<a name="l00040"></a>00040 
<a name="l00041"></a>00041     <a class="code" href="_o_p_plots_8m.html#a39cc4eae8cc13eaea23364936540819f">figure</a>(2);
<a name="l00042"></a>00042     <a class="code" href="_o_p_plots_8m.html#a4fbe616a6cbdd6d58fdf12c2d18a0846">plot</a>(<a class="code" href="_o_p_plots_8m.html#a354816d1f6a938030581fd6d1ccfebed">TimePA</a>,<a class="code" href="_o_p_plots_8m.html#a1eee7e566c5e608fa3a769ba1cdacfa6">PA</a>(1,:),TimePA,PA(2,:),TimeGPSPos,<a class="code" href="_o_p_plots_8m.html#ab94cab93b013b179c5a536b9c11a579d">GPSPos</a>(1,:),TimeGPSPos,GPSPos(2,:));
<a name="l00043"></a>00043     s1=&#39;Position Actual North&#39;;
<a name="l00044"></a>00044     s2=&#39;Position Actual East&#39;;
<a name="l00045"></a>00045     s3=&#39;GPS Position North&#39;;
<a name="l00046"></a>00046     s4=&#39;GPS Position East&#39;;
<a name="l00047"></a>00047     <a class="code" href="_o_p_plots_8m.html#acc66d65ee6dadbb2f185aed799ac4ff9">legend</a>(s1,s2,s3,s4);
<a name="l00048"></a>00048     <a class="code" href="_o_p_plots_8m.html#a2f72e827cc4394f62071090c2785a845">xlabel</a>(&#39;Time (sec)&#39;);
<a name="l00049"></a>00049     <a class="code" href="_o_p_plots_8m.html#acd883c737a299f2b0119aefb3cc90fc7">ylabel</a>(&#39;Position (<a class="code" href="uavobjecttemplate_8m.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>)&#39;);
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <a class="code" href="_o_p_plots_8m.html#a39cc4eae8cc13eaea23364936540819f">figure</a>(3);
<a name="l00052"></a>00052     <a class="code" href="_o_p_plots_8m.html#ab7d7c328d02bf4bb2ea25c4c5f3e149d">plot3</a>(PA(2,:),PA(1,:),PA(3,:),GPSPos(2,:),GPSPos(1,:),GPSPos(3,:));
<a name="l00053"></a>00053     s1=&#39;Pos Actual&#39;;
<a name="l00054"></a>00054     s2=&#39;GPS Pos&#39;;
<a name="l00055"></a>00055     <a class="code" href="_o_p_plots_8m.html#acc66d65ee6dadbb2f185aed799ac4ff9">legend</a>(s1,s2);
<a name="l00056"></a>00056     <a class="code" href="_o_p_plots_8m.html#a2f72e827cc4394f62071090c2785a845">xlabel</a>(&#39;East (m)&#39;);
<a name="l00057"></a>00057     <a class="code" href="_o_p_plots_8m.html#acd883c737a299f2b0119aefb3cc90fc7">ylabel</a>(&#39;North(m)&#39;);
<a name="l00058"></a>00058     <a class="code" href="_o_p_plots_8m.html#aeeb684aeaa0d79beb98d222d49107eed">zlabel</a>(&#39;Up (m)&#39;);
<a name="l00059"></a>00059     axis equal
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="_o_p_plots_8m.html#abb3119256791e93ec6e33c8eee7035d6">00063</a> <a class="code" href="uavobjecttemplate_8m.html#a2420833d971716e9bab41cc9fb3abba1">function</a> <a class="code" href="_o_p_plots_8m.html#abb3119256791e93ec6e33c8eee7035d6">NED</a> = LLA2Base(LLA,BaseECEF,Rne)
<a name="l00064"></a>00064         <a class="code" href="_o_p_plots_8m.html#a1ee0621678c54afffb4b6e50f10c9ab8">n</a> = size(LLA,2);
<a name="l00065"></a>00065         
<a name="l00066"></a><a class="code" href="_o_p_plots_8m.html#a2533e14f69f3f2d42c293390afb6d3aa">00066</a>         <a class="code" href="_o_p_plots_8m.html#a2533e14f69f3f2d42c293390afb6d3aa">ECEF</a> = LLA2ECEF(LLA);
<a name="l00067"></a>00067         
<a name="l00068"></a><a class="code" href="_o_p_plots_8m.html#acbb9d2dc78b59ac8322ba303b960b44b">00068</a>         <a class="code" href="_o_p_plots_8m.html#acbb9d2dc78b59ac8322ba303b960b44b">diff</a> = <a class="code" href="_o_p_plots_8m.html#a2533e14f69f3f2d42c293390afb6d3aa">ECEF</a> - repmat(BaseECEF,1,<a class="code" href="_o_p_plots_8m.html#a1ee0621678c54afffb4b6e50f10c9ab8">n</a>);
<a name="l00069"></a>00069         
<a name="l00070"></a>00070         <a class="code" href="_o_p_plots_8m.html#abb3119256791e93ec6e33c8eee7035d6">NED</a> = Rne*<a class="code" href="_o_p_plots_8m.html#acbb9d2dc78b59ac8322ba303b960b44b">diff</a>;
<a name="l00071"></a>00071 <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <a class="code" href="uavobjecttemplate_8m.html#a2420833d971716e9bab41cc9fb3abba1">function</a> LLA = Base2LLA(<a class="code" href="_o_p_plots_8m.html#abb3119256791e93ec6e33c8eee7035d6">NED</a>,BaseECEF,Rne)
<a name="l00074"></a>00074         n = size(NED,2);
<a name="l00075"></a>00075         
<a name="l00076"></a>00076         diff=Rne&#39;*NED;
<a name="l00077"></a>00077         <a class="code" href="_o_p_plots_8m.html#a2533e14f69f3f2d42c293390afb6d3aa">ECEF</a>=diff + repmat(BaseECEF,1,n) ;
<a name="l00078"></a>00078         
<a name="l00079"></a>00079         LLA=ECEF2LLA(<a class="code" href="_o_p_plots_8m.html#a2533e14f69f3f2d42c293390afb6d3aa">ECEF</a>);
<a name="l00080"></a>00080 <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 % <span class="comment">// ****** convert ECEF to Lat,Lon,Alt (ITERATIVE!) *********</span>
<a name="l00084"></a>00084 <a class="code" href="uavobjecttemplate_8m.html#a2420833d971716e9bab41cc9fb3abba1">function</a> LLA=ECEF2LLA(ECEF, Alt)
<a name="l00085"></a>00085 %       
<a name="l00094"></a>00094         if <a class="code" href="uavobjecttemplate_8m.html#aafbb9d50e573e4009d0650c645566ddd">nargin</a>==1
<a name="l00095"></a>00095                 Alt=0;
<a name="l00096"></a>00096         <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="_o_p_plots_8m.html#ab6991d210d93a78cdbdf6de1889c1259">00098</a>         <a class="code" href="_o_p_plots_8m.html#ab6991d210d93a78cdbdf6de1889c1259">a</a> = 6378137.0;  %<span class="comment">// Equatorial Radius</span>
<a name="l00099"></a><a class="code" href="_o_p_plots_8m.html#a9425be9aab51621e317ba7ade564b570">00099</a>         e = 8.1819190842622e-2;%;       <span class="comment">// Eccentricity</span>
<a name="l00100"></a><a class="code" href="_o_p_plots_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">00100</a>         <a class="code" href="_o_p_plots_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a> = ECEF(1);
<a name="l00101"></a><a class="code" href="_o_p_plots_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">00101</a>         <a class="code" href="_o_p_plots_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> = ECEF(2);
<a name="l00102"></a><a class="code" href="_o_p_plots_8m.html#a25ed1bcb423b0b7200f485fc5ff71c8e">00102</a>         <a class="code" href="_o_p_plots_8m.html#a25ed1bcb423b0b7200f485fc5ff71c8e">z</a> = ECEF(3);
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="_o_p_plots_8m.html#ad09e19a117d1006772ba28866830613d">00104</a>         <a class="code" href="_o_p_plots_8m.html#ad09e19a117d1006772ba28866830613d">MAX_ITER</a> =10;           %<span class="comment">// should not take more than 5 for valid coordinates</span>
<a name="l00105"></a><a class="code" href="_o_p_plots_8m.html#a9c5b823c1a5307b015de270505577839">00105</a>         <a class="code" href="_o_p_plots_8m.html#a9c5b823c1a5307b015de270505577839">ACCURACY</a>= 1.0e-11;%     <span class="comment">// used to be e-14, but we don&#39;t need sub micrometer exact calculations</span>
<a name="l00106"></a><a class="code" href="_o_p_plots_8m.html#a033bcbaee0381501054528c7d9541013">00106</a>         <a class="code" href="group___aero_sim_r_c.html#gabb429aecc5bba8de3564e19ded7ef104">RAD2DEG</a>=180/pi;
<a name="l00107"></a><a class="code" href="_o_p_plots_8m.html#afb79d9f14bae5ad3ff0e2433ef23e597">00107</a>         <a class="code" href="group___aero_sim_r_c.html#gacbfd2fc3314cc3762ea0c3720979f8bc">DEG2RAD</a>=1/<a class="code" href="group___aero_sim_r_c.html#gabb429aecc5bba8de3564e19ded7ef104">RAD2DEG</a>;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109         LLA(2) = RAD2DEG * atan2(<a class="code" href="_o_p_plots_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, <a class="code" href="_o_p_plots_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>);
<a name="l00110"></a><a class="code" href="_o_p_plots_8m.html#afdc4c4bc9859d268f8b5d1cc44b8ab7c">00110</a>         <a class="code" href="_o_p_plots_8m.html#afdc4c4bc9859d268f8b5d1cc44b8ab7c">Lat</a> = <a class="code" href="group___aero_sim_r_c.html#gacbfd2fc3314cc3762ea0c3720979f8bc">DEG2RAD</a> * LLA(1);
<a name="l00111"></a><a class="code" href="_o_p_plots_8m.html#a4268023e0b72098c8d8722f4573b5d3a">00111</a>         <a class="code" href="_o_p_plots_8m.html#a4268023e0b72098c8d8722f4573b5d3a">esLat</a> = e * sin(<a class="code" href="_o_p_plots_8m.html#afdc4c4bc9859d268f8b5d1cc44b8ab7c">Lat</a>);
<a name="l00112"></a><a class="code" href="_o_p_plots_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">00112</a>         <a class="code" href="_o_p_plots_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a> = <a class="code" href="_o_p_plots_8m.html#ab6991d210d93a78cdbdf6de1889c1259">a</a> / sqrt(1 - <a class="code" href="_o_p_plots_8m.html#a4268023e0b72098c8d8722f4573b5d3a">esLat</a> * <a class="code" href="_o_p_plots_8m.html#a4268023e0b72098c8d8722f4573b5d3a">esLat</a>);
<a name="l00113"></a><a class="code" href="_o_p_plots_8m.html#a26ca739b495b2df3ebcbe54a4b37a5a0">00113</a>         <a class="code" href="_o_p_plots_8m.html#a26ca739b495b2df3ebcbe54a4b37a5a0">NplusH</a> = <a class="code" href="_o_p_plots_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a>+Alt;
<a name="l00114"></a><a class="code" href="_o_p_plots_8m.html#a66db7c5e4e9699c54207ab857ae72cb7">00114</a>         <a class="code" href="_o_p_plots_8m.html#a66db7c5e4e9699c54207ab857ae72cb7">delta</a> = 1;
<a name="l00115"></a><a class="code" href="_o_p_plots_8m.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">00115</a>         <a class="code" href="_o_p_plots_8m.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a> = 0;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <a class="code" href="_o_p_plots_8m.html#a4b39dd8fd4db93ff3e5ed4f6230e041a">while</a> (((<a class="code" href="_o_p_plots_8m.html#a66db7c5e4e9699c54207ab857ae72cb7">delta</a> &gt; <a class="code" href="_o_p_plots_8m.html#a9c5b823c1a5307b015de270505577839">ACCURACY</a>) || (<a class="code" href="_o_p_plots_8m.html#a66db7c5e4e9699c54207ab857ae72cb7">delta</a> &lt; -<a class="code" href="_o_p_plots_8m.html#a9c5b823c1a5307b015de270505577839">ACCURACY</a>)) &amp;&amp; (<a class="code" href="_o_p_plots_8m.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a> &lt; <a class="code" href="_o_p_plots_8m.html#ad09e19a117d1006772ba28866830613d">MAX_ITER</a>)) 
<a name="l00118"></a>00118                 <a class="code" href="_o_p_plots_8m.html#a66db7c5e4e9699c54207ab857ae72cb7">delta</a> = Lat - atan(<a class="code" href="_o_p_plots_8m.html#a25ed1bcb423b0b7200f485fc5ff71c8e">z</a> / (sqrt(x * x + y * y) * (1 - (<a class="code" href="_o_p_plots_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a> * e * e / <a class="code" href="_o_p_plots_8m.html#a26ca739b495b2df3ebcbe54a4b37a5a0">NplusH</a>))));
<a name="l00119"></a>00119                 Lat = Lat - <a class="code" href="_o_p_plots_8m.html#a66db7c5e4e9699c54207ab857ae72cb7">delta</a>;
<a name="l00120"></a>00120                 esLat = e * sin(Lat);
<a name="l00121"></a>00121                 <a class="code" href="_o_p_plots_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a> = <a class="code" href="_o_p_plots_8m.html#ab6991d210d93a78cdbdf6de1889c1259">a</a> / sqrt(1 - esLat * esLat);
<a name="l00122"></a>00122                 NplusH = sqrt(x * x + y * y) / cos(Lat);
<a name="l00123"></a>00123                 <a class="code" href="_o_p_plots_8m.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a> = <a class="code" href="_o_p_plots_8m.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>+1;
<a name="l00124"></a>00124         <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00125"></a>00125 
<a name="l00126"></a>00126         LLA(1) = RAD2DEG * Lat;
<a name="l00127"></a>00127         LLA(3) = NplusH - <a class="code" href="_o_p_plots_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a>;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <a class="code" href="uavobjecttemplate_8m.html#a2420833d971716e9bab41cc9fb3abba1">function</a> ECEF = LLA2ECEF(LLA)
<a name="l00133"></a>00133 
<a name="l00134"></a>00134         <a class="code" href="_o_p_plots_8m.html#ab6991d210d93a78cdbdf6de1889c1259">a</a> = 6378137.0;  % Equatorial Radius
<a name="l00135"></a>00135         e = 8.1819190842622e-2; % Eccentricity
<a name="l00136"></a>00136         
<a name="l00137"></a><a class="code" href="_o_p_plots_8m.html#a1ee0621678c54afffb4b6e50f10c9ab8">00137</a>         n = size(LLA,2);
<a name="l00138"></a>00138         ECEF = zeros(3,n);
<a name="l00139"></a>00139         
<a name="l00140"></a><a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">00140</a>         for <a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>=1:n
<a name="l00141"></a>00141                 <a class="code" href="_o_p_plots_8m.html#af000cf7fd57b63001bb8346bebb6472c">sinLat</a> = sin(pi*LLA(1,<a class="code" href="_o_p_plots_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)/180);
<a name="l00142"></a><a class="code" href="_o_p_plots_8m.html#a545ef384c76a9d0cd05e512194aadff7">00142</a>                 <a class="code" href="_o_p_plots_8m.html#a545ef384c76a9d0cd05e512194aadff7">sinLon</a> = sin(pi*LLA(2,i)/180);
<a name="l00143"></a><a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">00143</a>                 <a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">cosLat</a> = cos(pi*LLA(1,i)/180);
<a name="l00144"></a><a class="code" href="_o_p_plots_8m.html#a6f7550e312de6f085807c22619b8b769">00144</a>                 <a class="code" href="_o_p_plots_8m.html#a6f7550e312de6f085807c22619b8b769">cosLon</a> = cos(pi*LLA(2,i)/180);
<a name="l00145"></a>00145                 
<a name="l00146"></a>00146                 N = a / sqrt(1.0 - e * e * <a class="code" href="_o_p_plots_8m.html#af000cf7fd57b63001bb8346bebb6472c">sinLat</a> * <a class="code" href="_o_p_plots_8m.html#af000cf7fd57b63001bb8346bebb6472c">sinLat</a>); %prime vertical radius of curvature
<a name="l00147"></a>00147                 
<a name="l00148"></a>00148                 ECEF(1,i) = (N + LLA(3,i)) * <a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">cosLat</a> * <a class="code" href="_o_p_plots_8m.html#a6f7550e312de6f085807c22619b8b769">cosLon</a>;
<a name="l00149"></a>00149                 ECEF(2,i) = (N + LLA(3,i)) * <a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">cosLat</a> * <a class="code" href="_o_p_plots_8m.html#a545ef384c76a9d0cd05e512194aadff7">sinLon</a>;
<a name="l00150"></a>00150                 ECEF(3,i) = ((1 - e * e) * N + LLA(3,i)) * sinLat;
<a name="l00151"></a>00151         <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00152"></a>00152 <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 % <span class="comment">// ****** find ECEF to NED rotation matrix ********</span>
<a name="l00155"></a>00155 <a class="code" href="uavobjecttemplate_8m.html#a2420833d971716e9bab41cc9fb3abba1">function</a>  Rne=RneFromLLA(LLA)
<a name="l00156"></a>00156         RAD2DEG=180/pi;
<a name="l00157"></a>00157         <a class="code" href="group___aero_sim_r_c.html#gacbfd2fc3314cc3762ea0c3720979f8bc">DEG2RAD</a>=1/RAD2DEG;
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="_o_p_plots_8m.html#af000cf7fd57b63001bb8346bebb6472c">00159</a>         sinLat = sin(<a class="code" href="group___aero_sim_r_c.html#gacbfd2fc3314cc3762ea0c3720979f8bc">DEG2RAD</a> * LLA(1));
<a name="l00160"></a>00160         sinLon = sin(<a class="code" href="group___aero_sim_r_c.html#gacbfd2fc3314cc3762ea0c3720979f8bc">DEG2RAD</a> * LLA(2));
<a name="l00161"></a>00161         <a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">cosLat</a> = cos(<a class="code" href="group___aero_sim_r_c.html#gacbfd2fc3314cc3762ea0c3720979f8bc">DEG2RAD</a> * LLA(1));
<a name="l00162"></a>00162         cosLon = cos(<a class="code" href="group___aero_sim_r_c.html#gacbfd2fc3314cc3762ea0c3720979f8bc">DEG2RAD</a> * LLA(2));
<a name="l00163"></a>00163 
<a name="l00164"></a>00164         Rne(1,1) = -sinLat * cosLon;
<a name="l00165"></a>00165         Rne(1,2) = -sinLat * sinLon;
<a name="l00166"></a>00166         Rne(1,3) = <a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">cosLat</a>;
<a name="l00167"></a>00167         Rne(2,1) = -sinLon;
<a name="l00168"></a>00168         Rne(2,2) = cosLon;
<a name="l00169"></a>00169         Rne(2,3) = 0;
<a name="l00170"></a>00170         Rne(3,1) = -<a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">cosLat</a> * cosLon;
<a name="l00171"></a>00171         Rne(3,2) = -<a class="code" href="_o_p_plots_8m.html#a495b98cbfa41dbf5df2090f1284568d8">cosLat</a> * sinLon;
<a name="l00172"></a>00172         Rne(3,3) = -sinLat;
<a name="l00173"></a>00173 <a class="code" href="uavobjecttemplate_8m.html#a770a3d65665549f29ddb8ee060c43cbc">end</a>
<a name="l00174"></a>00174 
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_o_p_plots_8m.html">OPPlots.m</a>      </li>

    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
